\documentclass[10pt,oneside]{book}

\ifx \HCode\Undef
\newcommand*{\topdir}{.}%
\else
\def\pgfsysdriver{pgfsys-tex4ht.def}
\newcommand*{\topdir}{..}%
\fi

\usepackage{calc}
\usepackage[capitalise]{cleveref}
\usepackage{enumitem}
\usepackage{environ}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{lipsum}
\usepackage{makeidx}
\usepackage{minted}
\usepackage{nameref}
\usepackage{tikz}
\usepackage[tikz]{bclogo}
\usepackage{ulem}
\usepackage[many]{tcolorbox}
\usepackage{etoolbox}
\usepackage{ifthen}
\usepackage{fontawesome}
\usepackage{xcolor}
\usepackage{tabularx}
\usepackage[margin=1in]{geometry}
\usepackage[small,compact]{titlesec}
\usepackage[binary,squaren]{SIunits}
\usepackage[framemethod=tikz]{mdframed}
\usetikzlibrary{arrows}
\usetikzlibrary{calc}
\usetikzlibrary{decorations.markings}

\makeindex
\AtBeginDocument{\renewcommand{\bibname}{References}}

\newcommand{\ConsusVersion}{0.0.dev}
\newcommand{\code}[1]{\texttt{#1}}

% http://texblog.org/2012/03/21/cross-referencing-list-items/
\makeatletter
\def\namedlabel#1#2{\begingroup
    #2%
    \def\@currentlabel{#2}%
    \phantomsection\label{#1}\endgroup
}
\makeatother

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{2}

\title{Consus Reference Manual v\ConsusVersion}
\author{Consus Team}

\BeforeBeginEnvironment{minted}{\begin{tcolorbox}}%
\AfterEndEnvironment{minted}{\end{tcolorbox}}%
\newminted{c}{samepage}
\newminted{console}{samepage}
\newminted{go}{samepage}
\newminted{java}{samepage}
\newminted{javascript}{samepage}
\newminted{json}{samepage}
\newminted{pycon}{samepage}
\newminted{python}{samepage}
\newminted{ruby}{samepage}

\input{environs}

\begin{document}

\frontmatter
\maketitle
\tableofcontents

\mainmatter

\part{Working with Consus}

\input{\topdir/installation}

%\part{Developing Consus}

%\part{API Reference}

\ifx \HCode\Undef % >>>>>>>>>>>>>>>>>>>
\backmatter

% Index
\clearpage
\addcontentsline{toc}{chapter}{Index}
\printindex

% References
\clearpage
\addcontentsline{toc}{chapter}{References}
\bibliographystyle{plain}
\bibliography{consus}
\fi               % <<<<<<<<<<<<<<<<<<<

\end{document}
